--- a/src/js/theme_template.js	2026-02-03 14:44:05.689329274 -0700
+++ b/src/js/theme_template.js	2026-02-03 14:44:34.122666174 -0700
@@ -26,7 +26,7 @@
    * @returns {boolean}
    */
   const themeStylesExist = (tokensEl, replacements) => {
-    return tokensEl.innerText !== '' && 
+    return tokensEl.innerText !== '' &&
       Object.keys(replacements).every(color => {
         return tokensEl.innerText.toLowerCase().includes(`#${color}`);
       });
@@ -36,7 +36,7 @@
    * @summary Search and replace colours within a CSS definition
    * @param {string} styles the text content of the style tag
    * @param {object} replacements key/value pairs of colour hex and the glow styles to replace them with
-   * @returns 
+   * @returns
    */
   const replaceTokens = (styles, replacements) => Object.keys(replacements).reduce((acc, color) => {
     const re = new RegExp(`color: #${color};`, 'gi');
@@ -48,32 +48,69 @@
    * @returns {boolean}
    */
   const usingSynthwave = () => {
+    // Check for our baked-in theme, extension theme, or any synthwave-related theme
     const appliedTheme = document.querySelector('[class*="theme-json"]');
-    const synthWaveTheme = document.querySelector('[class*="RobbOwen-synthwave-vscode-themes"]');
-    return appliedTheme && synthWaveTheme;
+    const synthWaveTheme = document.querySelector('[class*="RobbOwen-synthwave-vscode-themes"]') ||
+                          document.querySelector('[class*="synthwave-vscode"]') ||
+                          document.querySelector('[class*="Synthwave-VSCode"]') ||
+                          document.querySelector('[class*="synthwave"]') ||
+                          document.querySelector('[class*="Synthwave"]');
+
+    // Also check the body class and workbench theme attribute for baked-in themes
+    const bodyTheme = document.body.className.toLowerCase().includes('synthwave') ||
+                      document.body.className.toLowerCase().includes('neon') ||
+                      document.body.className.toLowerCase().includes('glow');
+
+    // For non-Nix extension use, be more permissive with theme detection
+    const hasAppliedTheme = appliedTheme || document.querySelector('.monaco-workbench');
+
+    return hasAppliedTheme && (synthWaveTheme || bodyTheme);
   }
 
   /**
    * @summary Checks if the theme is synthwave, and that the styles exist, ready for replacement
    * @param {HTMLElement} tokensEl the style tag
    * @param {object} replacements key/value pairs of colour hex and the glow styles to replace them with
-   * @returns 
+   * @returns
    */
-  const readyForReplacement = (tokensEl, tokenReplacements) => tokensEl 
+  const readyForReplacement = (tokensEl, tokenReplacements) => tokensEl
     ? (
       // only init if we're using a Synthwave 84 subtheme
-      usingSynthwave() &&         
+      usingSynthwave() &&
       // does it have content ?
       themeStylesExist(tokensEl, tokenReplacements)
     )
     : false;
 
   /**
+   * @summary Get VS Code settings (compatible with both extension and baked-in versions)
+   * @returns {object}
+   */
+  const getSettings = () => {
+    // For extension version, try to get settings from VS Code API
+    try {
+      if (typeof acquireVsCodeApi !== 'undefined') {
+        const vscode = acquireVsCodeApi();
+        // Extension can access workspace configuration
+        // For now, use build-time defaults since webview settings access is complex
+      }
+    } catch (e) {
+      // Settings API not available, use defaults
+    }
+
+    // Default settings - these will be replaced at build time for baked-in version
+    return {
+      disableGlow: [DISABLE_GLOW],
+      brightness: parseFloat('[NEON_BRIGHTNESS]') / 255 || 0.45
+    };
+  };
+
+  /**
    * @summary Attempts to bootstrap the theme
-   * @param {boolean} disableGlow 
-   * @param {MutationObserver} obs 
+   * @param {MutationObserver} obs
    */
-  const initNeonDreams = (disableGlow, obs) => {
+  const initNeonDreams = (obs) => {
+    const settings = getSettings();
     const tokensEl = document.querySelector('.vscode-tokens-styles');
 
     if (!tokensEl || !readyForReplacement(tokensEl, tokenReplacements)) {
@@ -83,20 +120,20 @@
     // Add the theme styles if they don't already exist in the DOM
     if (!document.querySelector('#synthwave-84-theme-styles')) {
       const initialThemeStyles = tokensEl.innerText;
-      
+
       // Replace tokens with glow styles
-      let updatedThemeStyles = !disableGlow 
-        ? replaceTokens(initialThemeStyles, tokenReplacements) 
+      let updatedThemeStyles = !settings.disableGlow
+        ? replaceTokens(initialThemeStyles, tokenReplacements)
         : initialThemeStyles;
-      
+
       /* append the remaining styles */
       updatedThemeStyles = `${updatedThemeStyles}[CHROME_STYLES]`;
-  
+
       const newStyleTag = document.createElement('style');
       newStyleTag.setAttribute("id", "synthwave-84-theme-styles");
       newStyleTag.innerText = updatedThemeStyles.replace(/(\r\n|\n|\r)/gm, '');
       document.body.appendChild(newStyleTag);
-      
+
       console.log('Synthwave \'84: NEON DREAMS initialised!');
     }
 
@@ -117,7 +154,7 @@
         const tokensEl = document.querySelector('.vscode-tokens-styles');
         if (readyForReplacement(tokensEl, tokenReplacements)) {
           // If everything we need is ready, then initialise
-          initNeonDreams([DISABLE_GLOW], observer);
+          initNeonDreams(observer);
         } else {
           if (tokensEl) {
             // sometimes VS code takes a while to init the styles content, so if there stop this observer and add an observer for that
@@ -136,8 +173,8 @@
   const bodyNode = document.querySelector('body');
   // Use a mutation observer to check when we can bootstrap the theme
   const observer = new MutationObserver(watchForBootstrap);
-  /* watch for both attribute and childList changes because, depending on 
-  the VS code version, the mutations might happen on the body, or they might 
+  /* watch for both attribute and childList changes because, depending on
+  the VS code version, the mutations might happen on the body, or they might
   happen on a nested div */
   observer.observe(bodyNode, { attributes: true, childList: true });
-})();
\ No newline at end of file
+})();
